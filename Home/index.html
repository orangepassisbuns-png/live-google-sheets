function buildTable(header, body, timestampIndex) {
    let html = "<div class='table-wrapper'><table><tr class='header'>";

    header.forEach(h => html += `<td>${h}</td>`);
    html += "</tr>";

    body.forEach(row => {
        html += "<tr>";
        row.forEach((cell, i) => {
            if (i === timestampIndex) {
                html += `<td>${formatTime(cell)}</td>`;
            } else {
                html += `<td>${cell}</td>`;
            }
        });
        html += "</tr>";
    });

    html += "</table></div>";
    return html;
}
